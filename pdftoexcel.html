<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Free online PDF to Excel converter. Extract tables and data from PDF files to editable Excel spreadsheets (XLSX) with our advanced tool.">
  <meta name="keywords" content="PDF to Excel, PDF to XLSX, convert PDF to Excel, extract PDF tables, online PDF converter">
  <meta name="author" content="PDF Converter Pro">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://yourwebsite.com/pdf-to-excel">
  
  <title>Advanced PDF to Excel Converter | Free Online Tool</title>
  
  <!-- Preload resources -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js" as="script">
  <link rel="preload" href="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js" as="script">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
  
  <!-- Favicon -->
  <link rel="icon" href="https://yourwebsite.com/favicon.ico" type="image/x-icon">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    :root {
      --primary: #4361ee;
      --secondary: #3a0ca3;
      --success: #4cc9f0;
      --danger: #f72585;
      --light: #f8f9fa;
      --dark: #212529;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f7ff;
      color: var(--dark);
      line-height: 1.6;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 1rem;
    }
    header {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      padding: 2rem 1rem;
      text-align: center;
    }
    h1 {
      margin: 0;
      font-size: 2.2rem;
    }
    .converter-box {
      background: white;
      border-radius: 10px;
      padding: 2rem;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      margin: 1.5rem 0;
    }
    .upload-area {
      border: 2px dashed #b8c1ec;
      border-radius: 8px;
      padding: 2.5rem;
      text-align: center;
      margin-bottom: 1.5rem;
      transition: all 0.3s;
      background-color: #f8f9fe;
      cursor: pointer;
    }
    .upload-area:hover {
      border-color: var(--primary);
      background-color: #edf2ff;
    }
    .upload-area i {
      font-size: 3rem;
      color: var(--primary);
      margin-bottom: 1rem;
    }
    #fileInput {
      display: none;
    }
    .btn {
      background-color: var(--primary);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      transition: all 0.3s;
      display: inline-block;
    }
    .btn:hover {
      background-color: var(--secondary);
      transform: translateY(-2px);
    }
    .btn:disabled {
      background-color: #adb5bd;
      cursor: not-allowed;
      transform: none;
    }
    #status {
      margin-top: 1rem;
      color: #6c757d;
      text-align: center;
    }
    .progress-container {
      margin: 1.5rem 0;
      display: none;
    }
    .progress-bar {
      height: 8px;
      background-color: #e9ecef;
      border-radius: 4px;
      overflow: hidden;
    }
    .progress {
      height: 100%;
      background: linear-gradient(to right, var(--primary), var(--success));
      width: 0%;
      transition: width 0.3s;
    }
    .preview-container {
      margin: 2rem 0;
      display: none;
    }
    .preview-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    .preview-table th, .preview-table td {
      padding: 0.75rem;
      border: 1px solid #dee2e6;
      text-align: left;
    }
    .preview-table th {
      background-color: #f1f3ff;
    }
    .error-message {
      color: var(--danger);
      text-align: center;
      margin: 1rem 0;
      display: none;
    }
    .ad-container {
      margin: 2rem 0;
      text-align: center;
      background: #f8f9fa;
      padding: 1rem;
      border-radius: 8px;
    }
    .ad-label {
      font-size: 0.8rem;
      color: #6c757d;
      margin-bottom: 0.5rem;
      text-transform: uppercase;
    }
    footer {
      text-align: center;
      padding: 2rem 0;
      color: #6c757d;
      font-size: 0.9rem;
    }
    @media (max-width: 768px) {
      .converter-box {
        padding: 1.5rem;
      }
      h1 {
        font-size: 1.8rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1><i class="fas fa-file-excel"></i> PDF to Excel Converter</h1>
      <p>Extract tables and data from PDF files to editable Excel spreadsheets</p>
    </div>
  </header>

  <main class="container">
    <!-- Top Ad Unit -->
    <div class="ad-container">
      <div class="ad-label">Advertisement</div>
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-app-pub-1893797822419017/5436817012"
           data-ad-slot="YOUR_TOP_AD_SLOT"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>

    <div class="converter-box">
      <div class="upload-area" id="dropArea">
        <i class="fas fa-cloud-upload-alt"></i>
        <h3>Drag & Drop Your PDF File</h3>
        <p>or click to browse files (Max 20MB)</p>
        <input type="file" id="fileInput" accept=".pdf">
        <button class="btn" onclick="document.getElementById('fileInput').click()">Select PDF File</button>
      </div>

      <div class="error-message" id="errorMsg"></div>

      <div class="preview-container" id="previewContainer">
        <h3>Preview (First Page)</h3>
        <table class="preview-table" id="previewTable"></table>
      </div>

      <div class="progress-container" id="progressContainer">
        <div class="progress-bar">
          <div class="progress" id="progressBar"></div>
        </div>
        <div id="status">Ready to convert</div>
      </div>

      <div style="text-align: center;">
        <button class="btn" id="convertBtn" onclick="convertPDFtoExcel()" disabled>
          <i class="fas fa-file-export"></i> Convert to Excel
        </button>
      </div>
    </div>

    <!-- Middle Ad Unit -->
    <div class="ad-container">
      <div class="ad-label">Advertisement</div>
      <ins class="adsbygoogle"
           style="display:block"
           data-ad-client="ca-app-pub-1893797822419017/5436817012"
           data-ad-slot="YOUR_MIDDLE_AD_SLOT"
           data-ad-format="auto"
           data-full-width-responsive="true"></ins>
      <script>
           (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>

    <!-- SEO Content -->
    <div class="converter-box">
      <h2>About Our PDF to Excel Converter</h2>
      <p>Our free online tool helps you convert PDF files to Excel spreadsheets (XLSX format) with high accuracy. Whether you need to extract tables, financial data, or any other information from PDFs, our converter preserves the original formatting and structure.</p>
      
      <h3>Key Features:</h3>
      <ul>
        <li>100% free with no watermarks</li>
        <li>Secure processing (files never leave your browser)</li>
        <li>Preserves table structures and formatting</li>
        <li>No registration required</li>
        <li>Works on all devices</li>
      </ul>
    </div>
  </main>

  <footer>
    <p>&copy; 2023 PDF Converter Pro. All rights reserved.</p>
    <p><a href="/privacy" style="color: var(--primary);">Privacy Policy</a> | <a href="/terms" style="color: var(--primary);">Terms of Service</a></p>
  </footer>

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

  <!-- AdSense Script -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-YOUR_AD_CLIENT_ID"
     crossorigin="anonymous"></script>

  <script>
    // Initialize PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js';

    // DOM elements
    const fileInput = document.getElementById('fileInput');
    const dropArea = document.getElementById('dropArea');
    const convertBtn = document.getElementById('convertBtn');
    const progressContainer = document.getElementById('progressContainer');
    const progressBar = document.getElementById('progressBar');
    const status = document.getElementById('status');
    const previewContainer = document.getElementById('previewContainer');
    const previewTable = document.getElementById('previewTable');
    const errorMsg = document.getElementById('errorMsg');

    // Drag and drop functionality
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, preventDefaults, false);
      document.body.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
      dropArea.addEventListener(eventName, highlight, false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
      dropArea.addEventListener(eventName, unhighlight, false);
    });

    function highlight() {
      dropArea.style.borderColor = 'var(--primary)';
      dropArea.style.backgroundColor = '#edf2ff';
    }

    function unhighlight() {
      dropArea.style.borderColor = '#b8c1ec';
      dropArea.style.backgroundColor = '#f8f9fe';
    }

    // Handle dropped files
    dropArea.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
      const dt = e.dataTransfer;
      const files = dt.files;
      fileInput.files = files;
      handleFiles(files);
    }

    // Handle selected files
    fileInput.addEventListener('change', function() {
      handleFiles(this.files);
    });

    function handleFiles(files) {
      errorMsg.style.display = 'none';
      
      if (files.length > 0) {
        const file = files[0];
        
        // Check file size (20MB limit)
        if (file.size > 20 * 1024 * 1024) {
          showError('File size exceeds 20MB limit');
          convertBtn.disabled = true;
          previewContainer.style.display = 'none';
          return;
        }
        
        if (file.type === 'application/pdf' || file.name.endsWith('.pdf')) {
          convertBtn.disabled = false;
          status.textContent = `Ready to convert: ${file.name}`;
          showPreview(file);
        } else {
          showError('Please select a valid PDF file');
          convertBtn.disabled = true;
          previewContainer.style.display = 'none';
        }
      }
    }

    function showError(message) {
      errorMsg.textContent = message;
      errorMsg.style.display = 'block';
    }

    async function showPreview(file) {
      try {
        const arrayBuffer = await readFileAsArrayBuffer(file);
        const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
        const page = await pdf.getPage(1);
        const textContent = await page.getTextContent();
        
        // Create preview table
        let html = '';
        const items = textContent.items.slice(0, 20); // Show first 20 items
        
        // Group items by line (y-position)
        const lines = {};
        items.forEach(item => {
          const y = Math.round(item.transform[5]);
          if (!lines[y]) lines[y] = [];
          lines[y].push(item);
        });
        
        // Sort lines from top to bottom
        const sortedY = Object.keys(lines).sort((a, b) => b - a);
        
        // Build preview table
        sortedY.forEach(y => {
          html += '<tr>';
          // Sort items in line from left to right
          lines[y].sort((a, b) => a.transform[4] - b.transform[4])
                 .forEach(item => {
                   html += `<td>${item.str}</td>`;
                 });
          html += '</tr>';
        });
        
        previewTable.innerHTML = html;
        previewContainer.style.display = 'block';
      } catch (error) {
        console.error('Preview error:', error);
        previewContainer.style.display = 'none';
      }
    }

    async function convertPDFtoExcel() {
      try {
        const file = fileInput.files[0];
        if (!file) throw new Error('No file selected');

        // Setup UI
        convertBtn.disabled = true;
        progressContainer.style.display = 'block';
        progressBar.style.width = '0%';
        status.textContent = 'Starting conversion...';
        errorMsg.style.display = 'none';

        // Read file
        const arrayBuffer = await readFileAsArrayBuffer(file);
        progressBar.style.width = '10%';
        status.textContent = 'Loading PDF document...';

        // Parse PDF
        const pdf = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
        progressBar.style.width = '20%';
        status.textContent = `Processing ${pdf.numPages} pages...`;

        const workbook = XLSX.utils.book_new();
        let allData = [];
        
        // Process each page
        for (let i = 1; i <= pdf.numPages; i++) {
          status.textContent = `Processing page ${i} of ${pdf.numPages}...`;
          const page = await pdf.getPage(i);
          const textContent = await page.getTextContent();
          
          // Group items by line (y-position)
          const lines = {};
          textContent.items.forEach(item => {
            const y = Math.round(item.transform[5]);
            if (!lines[y]) lines[y] = [];
            lines[y].push(item);
          });
          
          // Sort lines from top to bottom
          const sortedY = Object.keys(lines).sort((a, b) => b - a);
          
          // Process each line
          sortedY.forEach(y => {
            const lineItems = lines[y];
            // Sort items in line from left to right
            lineItems.sort((a, b) => a.transform[4] - b.transform[4]);
            
            // Create row data
            const row = lineItems.map(item => item.str);
            allData.push(row);
          });
          
          // Update progress
          const progressPercent = 20 + (i / pdf.numPages * 70);
          progressBar.style.width = `${progressPercent}%`;
        }

        // Create worksheet
        const ws = XLSX.utils.aoa_to_sheet(allData);
        XLSX.utils.book_append_sheet(workbook, ws, "Extracted Data");

        // Generate Excel file
        progressBar.style.width = '95%';
        status.textContent = 'Generating Excel file...';
        
        const fileName = file.name.replace(/\.pdf$/i, '') + '.xlsx';
        XLSX.writeFile(workbook, fileName);
        
        progressBar.style.width = '100%';
        status.textContent = 'Conversion complete!';
      } catch (error) {
        console.error('Conversion error:', error);
        showError(`Conversion failed: ${error.message}`);
        progressBar.style.background = 'var(--danger)';
        status.textContent = 'Conversion failed';
      } finally {
        convertBtn.disabled = false;
      }
    }

    function readFileAsArrayBuffer(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsArrayBuffer(file);
      });
    }

    // Initialize AdSense ads
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof adsbygoogle !== 'undefined') {
        adsbygoogle.push({});
      }
    });
  </script>
</body>
</html>
